# Vulnerability Details: Vulnerable Local Web Server

This document describes the "Vulnerable Local Web Server" vulnerability intentionally integrated into the PurpleCloud application for security testing purposes.

## Feature: Wi-Fi Sharing

The vulnerability is hidden within the "Wi-Fi Sharing" feature.

- **Purpose**: This feature allows a user to easily download their files to a computer on the same Wi-Fi network without needing a cable.
- **Functionality**: When the user enables "Wi-Fi Sharing" in the app, the app starts a local web server on the device. It displays the server's local network URL (e.g., `http://192.168.1.10:8080`) and a 6-digit verification code. The user can then access their files from a web browser on another computer.

## The Vulnerability: Path Traversal

The local web server is insecure by design and contains a classic **Path Traversal** vulnerability.

- **The Flaw**: The server expects file paths to be provided via a URL query parameter named `path` (e.g., `/file?path=documents/report.pdf`). The server code takes the value of this `path` parameter and directly appends it to the user's root storage directory to locate the file on the device's filesystem. Crucially, the server **does not sanitize or validate** the `path` parameter. It fails to check for directory traversal sequences like `../`.

- **Authentication**: While the feature includes a verification code, this only serves as a superficial barrier. An attacker on the same network who can obtain this code (e.g., by social engineering or shoulder surfing) can bypass this check and exploit the underlying path traversal flaw.

## The Attack

An attacker on the same local network can exploit this vulnerability to read sensitive files from the application's private data directory, far outside the intended user-specific folder.

1.  The attacker obtains the server URL and the verification code from the user's device.
2.  The attacker crafts a URL that uses `../` sequences in the `path` parameter to navigate up the directory tree and then into other parts of the app's sandboxed storage.

### Example Payload

To steal the `AuthPrefs.xml` file, which contains the user's authentication tokens, an attacker would use a URL like the following:

```
http://<DEVICE_IP>:8080/file?path=../../../../shared_prefs/AuthPrefs.xml&code=<VERIFICATION_CODE>
```

- `<DEVICE_IP>` is the IP address of the user's device, as shown in the app.
- `<VERIFICATION_CODE>` is the 6-digit code displayed on the screen.

### Impact

Successful exploitation of this vulnerability leads to the disclosure of sensitive information stored within the app's private data directory. This can include:

- Authentication tokens, allowing for full account takeover.
- User directory listings (`.items` files).
- Any other data the application stores internally.
