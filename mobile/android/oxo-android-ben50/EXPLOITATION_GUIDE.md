# oxo-android-ben50 Exploitation Guide

## Vulnerability: Incorrect URL Verification

### Vulnerable Code Location
`WebViewActivity.java` - `isUrlAllowed()` method only checks URL protocol, not domain.

## Exploitation Methods

### Method 1: Intent Data Manipulation
1. **Hook the Intent**: Use Frida or Xposed to hook the Intent data
2. **Replace URL**: Modify the article URL before WebView loads it
3. **Payload Example**: Replace `https://www.bbc.com/news/article-123` with `https://evil-site.com/phishing`

### Method 2: Network Interception (MitM)
1. **Setup Proxy**: Configure Burp Suite/ZAP as system proxy
2. **Intercept API Response**: Capture the RSS2JSON or BBC RSS response
3. **Modify Response**: Replace legitimate URLs with malicious ones
4. **Forward Modified Data**: Let the app process the tampered response

### Method 3: DNS Poisoning
1. **Local DNS Override**: Modify /etc/hosts or use DNS hijacking
2. **Redirect Domains**: Point legitimate domains to attacker-controlled servers
3. **Serve Malicious Content**: Host phishing pages that mimic real news sites

## Sample Malicious URLs That Will Pass Validation

```
https://fake-bbc-news.evil.com/breaking-news
https://phishing-site.com/steal-credentials
https://malware-host.net/download-virus
https://bit.ly/redirect-to-evil (URL shortener to bypass detection)
```

## Proof of Concept Attack Scenarios

### Scenario 1: Credential Harvesting
- Replace news URL with fake login page
- User sees "BBC News Login Required" page
- Credentials sent to attacker's server

### Scenario 2: Malware Distribution
- Replace article URL with malware download link
- User clicks "Read Full Article"
- Browser downloads malicious APK/file

### Scenario 3: XSS/JavaScript Injection
- Host malicious page with JavaScript payload
- Execute scripts in WebView context
- Access sensitive app data or device information

## Technical Exploitation Steps

### Using Frida (Runtime Manipulation)
```javascript
Java.perform(function() {
    var WebViewActivity = Java.use("com.newsreader.app.WebViewActivity");
    
    WebViewActivity.isUrlAllowed.implementation = function(url) {
        console.log("[+] Original URL: " + url);
        
        // Replace with malicious URL
        if (url.includes("bbc.com")) {
            var maliciousUrl = "https://evil-phishing-site.com/fake-bbc";
            console.log("[+] Redirecting to: " + maliciousUrl);
            return this.isUrlAllowed(maliciousUrl);
        }
        
        return this.isUrlAllowed(url);
    };
});
```

### Using Burp Suite (Network Interception)
1. Configure Android device to use Burp as proxy
2. Intercept HTTP/HTTPS traffic from NewsReader app
3. Find RSS2JSON API responses
4. Use "Replace" rules to modify article URLs
5. Forward modified responses to app

## Defensive Measures (What Should Be Implemented)

```java
// Secure URL validation example
private boolean isUrlAllowed(String url) {
    if (url == null || url.trim().isEmpty()) {
        return false;
    }
    
    // Whitelist of trusted domains
    String[] trustedDomains = {
        "bbc.com", "www.bbc.com", "bbc.co.uk",
        "cnn.com", "www.cnn.com",
        "reuters.com", "www.reuters.com"
    };
    
    try {
        URL urlObj = new URL(url);
        String host = urlObj.getHost().toLowerCase();
        
        for (String domain : trustedDomains) {
            if (host.equals(domain) || host.endsWith("." + domain)) {
                return true;
            }
        }
    } catch (MalformedURLException e) {
        return false;
    }
    
    return false;
}
```

## Risk Assessment
- **Impact**: High (Credential theft, malware distribution, XSS)
- **Likelihood**: Medium (Requires network access or device compromise)
- **Overall Risk**: High

## Remediation Priority
- **Critical**: Implement domain whitelist validation
- **High**: Add certificate pinning for news sources
- **Medium**: Implement Content Security Policy headers
- **Low**: Add user warnings for external links
